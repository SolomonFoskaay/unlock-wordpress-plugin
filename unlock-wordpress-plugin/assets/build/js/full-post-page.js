!function(){"use strict";var e={n:function(t){var o=t&&t.__esModule?function(){return t.default}:function(){return t};return e.d(o,{a:o}),o},d:function(t,o){for(var n in o)e.o(o,n)&&!e.o(t,n)&&Object.defineProperty(t,n,{enumerable:!0,get:o[n]})},o:function(e,t){return Object.prototype.hasOwnProperty.call(e,t)}},t=window.wp.element,o=window.wp.i18n,n=window.wp.plugins,l=window.wp.editPost,c=window.wp.components,r=window.React,a=window.wp.apiFetch,s=e.n(a),u=window.wp.data;const i=()=>s()({path:"/unlock-protocol/v1/settings"}).then((e=>{let t=e.networks,n=[{label:(0,o.__)("None","unlock-protocol"),value:-1}];return Object.entries(t).forEach((e=>{let[t,o]=e;n.push({label:o.network_name.charAt(0).toUpperCase()+o.network_name.slice(1),value:o.network_id})})),n})).catch((e=>(console.error(e),[]))),d=e=>{let{handleSave:n}=e;const[l,a]=(0,r.useState)(),[s,u]=(0,r.useState)(),[d,p]=(0,r.useState)(""),[k,m]=(0,r.useState)([]);(0,r.useEffect)((()=>{i().then((e=>{m(e)}))}),[]);const w=e=>/^0x[a-fA-F0-9]{40}$/.test(e);return k?(0,t.createElement)("form",{onSubmit:e=>(e.preventDefault(),n({network:l,address:s}),!1)},(0,t.createElement)("div",{className:"add-lock-form"},(0,t.createElement)(c.SelectControl,{label:(0,o.__)("Network","unlock-protocol"),options:k,value:l,onChange:e=>a(parseInt(e))}),(0,t.createElement)("p",{className:"label"},(0,o.__)("Lock Address","unlock-protocol")),(0,t.createElement)(c.TextControl,{disabled:!l,value:s,onChange:e=>{w(e)?p(""):p((0,o.__)("Invalid Lock address","unlock-protocol")),u(e)}}),d&&(0,t.createElement)("p",{className:"lock-warning"},d),(0,t.createElement)(c.Button,{disabled:!l||!w(s),className:"add-lock",type:"submit"},(0,o.__)("Add New Lock","unlock-protocol")))):null},p=e=>{let{lock:o,onRemove:n}=e;const[l,a]=(0,r.useState)();return(0,r.useEffect)((()=>{i().then((e=>{e.forEach((e=>{let{value:t,label:n}=e;t===o.network&&a(`${n}: ${function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:18,o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"...";if(e.length<=t)return e;o=o||"...";var n=t-o.length,l=Math.ceil(n/2),c=Math.floor(n/2);return e.substr(0,l)+o+e.substr(e.length-c)}(o.address)}`)}))}))}),[o.network]),(0,t.createElement)("li",{style:{display:"flex","justify-content":"space-between"}},(0,t.createElement)("span",null,l),(0,t.createElement)(c.Button,{isSmall:!0,isDestructive:!0,onClick:()=>{removeLock(id)}},"remove"))};var k=e=>{const[o,n]=(0,r.useState)(!1),{locks:l,postId:a}=(0,u.useSelect)((e=>{const{getCurrentPostId:t,getEditedPostAttribute:o}=e("core/editor"),n=o("meta");let l=[];return n.unlock_protocol_post_locks&&(l=JSON.parse(n.unlock_protocol_post_locks)),{postId:t(),locks:l}}),[]),{editPost:s}=(0,u.useDispatch)("core/editor",[l]),i=(0,r.useCallback)((e=>s({meta:{unlock_protocol_post_locks:JSON.stringify(e)}})),[s]);return a?(0,t.createElement)("div",null,(0,t.createElement)("ul",null,l.map(((e,o)=>(0,t.createElement)(p,{lock:e,onRemove:()=>{(async e=>{const t=[...l];t.splice(e,1),await i(t)})(o)}})))),(0,t.createElement)(c.Button,{className:"components-button is-link",onClick:()=>n(!o)},"Add Lock"),o&&(0,t.createElement)(d,{handleSave:async e=>{await i([...l,e]),n(!1)}})):null};(0,n.registerPlugin)("unlock-protocol-unlock-box-full-post-page",{render:()=>(0,t.createElement)(l.PluginDocumentSettingPanel,{name:"full-post-page-lock",title:(0,o.__)("Unlock Protocol","unlock-protocol")},(0,t.createElement)("p",null,(0,o.__)("Add lock(s) to restrict access to the full post/page content inside of WordPress.","unlock-protocol")," ",(0,t.createElement)("a",{rel:"noopener noreferrer",target:"_blank",href:unlockProtocol.unlock_docs.docs},(0,o.__)("Documentation","unlock-protocol"))),(0,t.createElement)(k,null))})}();