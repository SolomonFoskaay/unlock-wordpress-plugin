!function(){"use strict";var e={n:function(o){var t=o&&o.__esModule?function(){return o.default}:function(){return o};return e.d(t,{a:t}),t},d:function(o,t){for(var n in t)e.o(t,n)&&!e.o(o,n)&&Object.defineProperty(o,n,{enumerable:!0,get:t[n]})},o:function(e,o){return Object.prototype.hasOwnProperty.call(e,o)}},o=window.wp.i18n,t=window.wp.plugins,n=window.wp.editPost,l=window.wp.element,r=window.wp.components,c=window.React,a=window.wp.data,s=window.wp.coreData,i=window.wp.apiFetch,u=e.n(i);const k=e=>{let o=!0;return 0===e.length&&(o=!1),e.forEach((e=>{-1!==e.network&&d(e)||(o=!1)})),o},d=e=>-1===e.network||!!e.address&&!!new RegExp("^0x[a-fA-F0-9]{40}$","g").test(e.address);(0,n.addMetaBox)("unlock-protocol",{title:(0,o.__)("Unlock Protocol","unlock-protocol"),context:"side",icon:"lock",description:(0,o.__)("Lock or unlock the full post/page with Unlock Protocol.","unlock-protocol"),attributes:{locks:{type:"array",default:[]},ethereumNetworks:{type:"array",default:[]}},render:function(e){let{attributes:t,setAttributes:n}=e;const{locks:i,ethereumNetworks:p}=t;(0,c.useEffect)((()=>{u()({path:"/unlock-protocol/v1/settings"}).then((e=>{let t=e.networks,l=[{label:(0,o.__)("None","unlock-protocol"),value:-1}];Object.entries(t).forEach((e=>{let[o,t]=e;l.push({label:t.network_name,value:t.network_id})})),n({ethereumNetworks:l})})).catch((e=>{}))}),[]);const w=(e,o,t)=>{i[e][o]=t,n({locks:[...i]})},m=()=>(wp.data.dispatch("core/editor").lockPostSaving("my-lock"),(0,l.createElement)("div",{className:"no-lock-address"},(0,l.createElement)("p",null,(0,o.__)("Please configure the lock(s) on this block.","unlock-protocol"))));return(0,l.createElement)(l.Fragment,null,(0,l.createElement)("div",useBlockProps(),(0,l.createElement)(InspectorControls,null,(0,l.createElement)(r.PanelBody,{title:(0,o.__)("Locks","unlock-protocol")},i.map(((e,t)=>(0,l.createElement)("div",{class:"setting-lock"},(0,l.createElement)(r.SelectControl,{label:(0,o.__)("Network","unlock-protocol"),value:e.network,options:p,onChange:e=>w(t,"network",parseInt(e))}),-1!==e.network?(0,l.createElement)(l.Fragment,null,(0,l.createElement)("p",{className:"block-label"},(0,o.__)("Lock Address","unlock-protocol")),(0,l.createElement)(r.TextControl,{value:e.address,onChange:e=>w(t,"address",e)})):"",!d(e)&&(0,l.createElement)("p",{className:"lock-warning"},(0,o.__)("Lock address is not valid","unlock-protocol")),(0,l.createElement)(r.Button,{isSmall:!0,isDestructive:!0,onClick:()=>{(e=>{const o=[...i];o.splice(e,1),n({locks:o})})(t)}},"Remove")))),(0,l.createElement)(r.PanelRow,null,(0,l.createElement)(r.Button,{className:"add-lock",variant:"primary",onClick:()=>{n(i?{locks:[...i,{address:"",network:-1}]}:{locks:[{address:"",network:-1}]})}},"Add Lock")),(0,l.createElement)("div",{className:"docs"},(0,l.createElement)("a",{rel:"noopener noreferrer",target:"_blank",href:unlockProtocol.unlock_docs.docs},(0,o.__)("Unlock's documentation","unlock-protocol")),(0,l.createElement)("br",null),(0,l.createElement)("a",{rel:"noopener noreferrer",target:"_blank",href:unlockProtocol.unlock_docs.deploy_lock},(0,o.__)("Deploy a lock","unlock-protocol"))))),(0,l.createElement)("div",{className:"unlock-header-icon"}),k(i)?(()=>{const{isSavingPost:e}=(0,a.useSelect)((e=>{const{isSavingPost:o}=e("core/editor");return{isSavingPost:o}})),[o,t]=(0,s.useEntityProp)("postType","post","meta"),n=o["unlock-protocol"]?o["unlock-protocol"].locks:[];return(0,c.useEffect)((()=>{k(n)||e?wp.data.dispatch("core/editor").unlockPostSaving("my-lock"):wp.data.dispatch("core/editor").lockPostSaving("my-lock")}),[n]),(0,l.createElement)("div",useBlockProps(),k(n)?(0,l.createElement)(InnerBlocks,null):m())})():m()))}}),(0,t.registerPlugin)("unlock-protocol",{render:()=>null})}();